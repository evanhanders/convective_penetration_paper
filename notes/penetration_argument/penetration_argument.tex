\documentclass[12pt]{article}
\usepackage{natbib}
\bibliographystyle{aasjournal}
\usepackage{latexsym}
\usepackage{graphicx}
\usepackage{epsfig}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{epstopdf}

\usepackage{pb-diagram}

\parindent = 0.0 in
\parskip = 0.15 in

\newcommand\Beq{\begin{align}} 
\newcommand\Eeq{\end{align}}

\newcommand\Bfig{\begin{figure}} 
\newcommand\Efig{\end{figure}}

\newcommand\Ra{\mathrm{Ra}}
\newcommand\Pran{\mathrm{Pr}}
\newcommand\Rac{\mathrm{Ra}_{\mathrm{c}}}
\newcommand\Ek{\mathrm{Ek}}
\newcommand\Ro{\mathrm{Ro}}
\newcommand\Nu{\mathrm{Nu}}
\newcommand\Sc{\mathrm{Sc}}

\newcommand\eps{\varepsilon}
\renewcommand\L {\mathcal{L}}

\newcommand{\n}{\\ \nonumber \\ }
\newcommand{\nn}{\nonumber}
\newcommand{\nnn}{\\ \nonumber \\ \nonumber}

\newcommand\ie{\textit{i.e.},~}
\newcommand\eg{\textit{e.g.},~}
\newcommand{\omicron}{o}

\newcommand{\pd}[1]{\partial_{#1}}
\renewcommand{\vec}[1]{\boldsymbol{#1}}
\newcommand{\M}[1]{\mathbf{#1}}
\renewcommand{\dot}{\vec{\cdot}}
\newcommand{\grad}{\vec{\nabla}}
\newcommand{\cross}{\vec{\times}}
\newcommand{\laplacian}{\nabla^2}

\newcommand{\sump}[2]{\sideset{}{'}\sum_{{#1}=0}^{#2}}

\newcommand{\eq}[1]{eq.~(\ref{#1})}
\newcommand{\eqs}[2]{eqs.~(\ref{#1})~\&~(\ref{#2})}
\newcommand{\eqss}[2]{eqs.~(\ref{#1})--(\ref{#2})}

\newcommand{\Eq}[1]{Eq.~(\ref{#1})}
\newcommand{\Eqs}[2]{Eqs.~(\ref{#1})~\&~(\ref{#2})}
\newcommand{\Eqss}[2]{Eqs.~(\ref{#1})--(\ref{#2})}

\newcommand{\fig}[1]{Fig.~(\ref{#1})}
\newcommand{\figs}[2]{Figs.~(\ref{#1})~\&~(\ref{#2})}

\newcommand{\tbl}[1]{Table~(#1)}

\newcommand{\aap}{A\&A}

\begin{document}

\section{Dimensional equations}
The dimensional Boussinesq equations are
\begin{align}
&\grad\dot\vec{u} = 0 \label{eqn:continuity} \\
&\partial_t \vec{u} + \vec{u}\dot\grad\vec{u} = -\frac{1}{\rho_0}\grad p + \frac{\rho'}{\rho_0}\vec{g} + \nu\grad^2 \vec{u} \label{eqn:momentum} \\
&\partial_t T + \vec{u}\dot\grad T + w \grad_{\rm{ad}} = \chi\grad^2 T' + \grad\dot[k \grad \overline{T}] + Q \label{eqn:temperature} \\
&\frac{\rho'}{\rho_0} = -|\alpha| T \label{eqn:boussinesq}
\end{align}
Where $\rho$ is the density, $T$ is the temperature, $\vec{g}$ is the gravitational acceleration, $\alpha$ is the coefficient of thermal expansion, $\nu$ and $\chi$ are the viscous and thermal diffusivity, $k$ is a radiative diffusivity, and $Q$ is a heating term.
We have baked in an assumption that $\alpha < 0$ to make sign conventions more straightforward after substituting Eqn.~\ref{eqn:boussinesq} into Eqn.~\ref{eqn:momentum}.

\section{Convective Penetration argument}
First some definitions:
\begin{enumerate}
\item $z=L_s$ is the the top of the convection zone according to the Schwarzschild criterion; it's the height where $\grad_{\rm{ad}} = \grad_{\rm{rad}}$.
\item $L_{\rm{cz}}$ is the top of the convection zone; it's roughly the top of the region where convection flattens $\grad \rightarrow \grad_{\rm{ad}}$.
We generally get $L_{\rm{cz}} > L_s$.
\item The penetration depth is $\delta_p = L_{\rm{cz}} - L_s$.
\item The flux carried by convection for $z < L_s$ is $F_{\rm{conv,cz}} = Q \delta_H$, where $Q$ is the magnitude of the internal heating and $\delta_H$ is the depth of the heating layer.
\item $\overline{w}$ is the vertical profile of the characteristic (vertical) convective velocity, which is a constant $w_{\rm{cz}}$ for $z \leq L_{\rm{cz}}$.
\item Similarly, $\overline{\delta T}$ is the vertical profile of the characteristic temperature perturbation.
\end{enumerate}

And some key assumptions.
\begin{enumerate}
\item Convection flattens $\grad \rightarrow \grad_{\rm{ad}}$ for $z \leq L_{\rm{cz}}$ (baked into our definitions).
\item We assume a system in thermal equilibrium, at least in (adiabatic) convection zone with $z \leq L_{\rm{cz}}$.
Therefore $F_{\rm{conv}}(z) = F_{\rm{tot}}(z) - F_{\rm{rad, ad}}(z)$, where $F$ is a flux and $F_{\rm{rad, ad}}$ is the radiative flux along the adiabatic gradient.
\item We assume $F_{\rm{conv}} = \overline{w T} \approx \overline{w}\overline{\delta T}$.
Combined with our previous assumption, we get
\begin{equation}
\overline{\delta T} \approx \frac{F_{\rm{tot}}(z) - F_{\rm{rad, ad}}(z)}{\overline{w}}.
\label{eqn:dT_assumption}
\end{equation}
\end{enumerate}
As we increase in height, the conductivity and thus $F_{\rm{rad, ad}}(z)$ also increases.
This means that $\overline{\delta T}$ has the opposite sign of $\overline{w}$ for $z > L_s$.

We presume that buoyancy breaking is the dominant mechanism which brings convective motions to a stop in this adiabatic layer.
In other words, we assume that, if we drop the nonlinear, pressure, and viscous terms from Eqn.~\ref{eqn:momentum}, we describe the dynamics reasonably well,
\begin{equation}
\frac{d \overline{w}}{dt} = \frac{\overline{\rho'}}{\rho_0}(-g\hat{z}) = \alpha g\, \overline{\delta T} = \alpha g \, \frac{F_{\rm{tot}}(z) - F_{\rm{rad, ad}}(z)}{\overline{w}}.
\end{equation}
If we multiply both sides by $\overline{w}$ and absorb it into the the derivative, then apply the chain rule with $d/dt = d/dz (dz/dt) = d/dz \overline{w}$, we retrieve,
\begin{equation}
\frac{1}{2} d\overline{w}^3 = \alpha g\, \left[F_{\rm{tot}}(z) - F_{\rm{rad, ad}}(z)\right]dz.
\end{equation}
We now replace $F_{\rm{rad, ad}}(z) = k_0(z) \grad_{\rm{ad}}$, and we assume that $k(z)$ instantaneously jumps from a low value $k_{\rm{cz}}$ to a high value $k_{\rm{rz}}$ at $z = L_s$.
Per this assumption, the convective flux is a negative constant for $z \geq L_s$.
We integrate from $z = L_s$ with $\overline{w} = w_{\rm{cz}}$ to $z = L_{s}$ with $\overline{w} = 0$, and get
\begin{equation}
-\frac{w_{\rm{cz}}^3}{2} = \alpha g\, F_{\rm{conv,p}}\,  \delta_p.
\end{equation}
By definition, the convective flux in the penetrative layer with $z > L_s$ is related to $\mathcal{P}$,
\begin{equation}
F_{\rm{conv,p}} = -\frac{F_{\rm{conv,cz}}}{\mathcal{P}},
\end{equation}
so we retrieve
\begin{equation}
\delta_p = \frac{w_{\rm{cz}}^3}{2\alpha g\, F_{\rm{conv, cz}}}  \mathcal{P},
\end{equation}
and the penetration depth scales with the cube of the velocity and linearly with $\mathcal{P}$.
This prediction does not exactly line up with the simulation results (this overpredicts the magnitude of $\delta_p$).
The important thing we need to determine is if it scales with $w_{\rm{cz}}$, $\mathcal{P}$, and $F_{\rm{conv,cz}}$ in the appropriate way.
So far, it seems to scale linearly with $\mathcal{P}$ at fixed other parameters.

Finally, we note that for an ideal gas with $P = \mathcal{R} \rho T$,
\begin{equation}
\alpha = \frac{\partial \ln\rho}{\partial T} = \frac{1}{\rho}\frac{\partial\rho}{\partial T} \approx - T^{-1}.
\end{equation}
If we had assumed that the convective flux had the form $\rho c_p w \delta T$ during Eqn.~\ref{eqn:dT_assumption}, we would have retrieved
\begin{equation}
\delta_p = \frac{\rho\, c_p\, w_{\rm{cz}}^3}{2\alpha g\, F_{\rm{conv, cz}}}  \mathcal{P}
\qquad \Rightarrow \qquad
\frac{\delta_p}{H_P} = \frac{\rho\, w_{\rm{cz}}^3}{2 F_{\rm{conv, cz}}}  \mathcal{P},
\end{equation}
with $H_P = c_P T / g$ the rough pressure scale height.

\section{Zahn argument}
Here we will work through a Boussinesq version of the argument in section 3.1 of \citet{zahn1991}.
In the adiabatic penetrative region, we know that the radiative flux is
\begin{equation}
F_{\rm{rad}} = -k \frac{\partial T_{\rm{ad}}}{\partial z}
\end{equation}
Further, we know that the convective flux is the difference between the total total and radiative flux,
\begin{equation}
F_{\rm{conv}} = F_{\rm{tot}} - F_{\rm{rad}}.
\end{equation}
Furthermore, the convective flux is
\begin{equation}
F_{\rm{conv}} = \overline{w T} = f \, W(z) \, \delta T(z),
\end{equation}
where $f$ is the filling factor of the flows that carry the flux in the penetration zone (upflows) and $W$ and $T$ give the vertical shape of typical velocity and temperature perturbations.

We next assume that the temperature and velocity are highly correlated in the overshooting convective motions (upflows).
This allows us to describe the horizontal nature of all fields in upflows using a function $h(x,y)$ so that
\begin{equation}
w(x,y,z) = W(z) h(x,y)
\qquad
T'(x,y,z) = \delta T(z) h(x,y),
\end{equation}
where $T'$ are the temperature fluctuations away from the mean.
By continuity and by our above definition of the convective flux, we have
\begin{equation}
\overline{h} = 0,
\qquad
\overline{h^2} = f.
\end{equation}
Furthermore, as in \citet{zahn1991}, $h$ is normalized so that its mean square averages to zero over the area where $h > 0$,
\begin{equation}
\overline{h^2 \mu(x,y)} = 1,
\end{equation}
where $\mu(x,y) = (1 + h/|h|)/2$, which is 1 when $h > 0$ and 0 when $h \leq 0$.

Per the momentum equation, the deceleration of plumes in the penetration zone is described by buoyancy breaking,
\begin{equation}
\frac{d w^2}{dz} = \alpha g T'.
\end{equation}
Multiplying by $h$ (to preserve the LHS) and taking a horizontal average, we get
\begin{equation}
\frac{\overline{h^3}}{\alpha g f}d W^2 = \delta T dz.
\end{equation}
After elimination of $\delta T$ with the formula for $F_{\rm{conv}}$, we integrate
\begin{equation}
\frac{\overline{h^3}}{3 \alpha g}\int_{W_0}^0 dW^3 = \int_{L_{\rm{cz}}}^{L_{\rm{cz}} + L_p} F_{\rm{conv}}\, dz,
\label{eqn:buoyancy_integral}
\end{equation}
assuming that the velocity drops to roughly $W = 0$ at $z = L_{\rm{cz}} + L_p$, where $L_{\rm{cz}}$ is the height where $\grad_{\rm{rad}} = \grad_{\rm{ad}}$.

At this point we will consider two cases:
\begin{enumerate}
\item The ``erf'' simulations, where we assume that $F_{\rm{conv}}$ jumps from a value of $F_0$ in the CZ to a value of $-F_0/\mathcal{P}$ in the PZ.
In this case, integration of a constant straightforwardly returns
\begin{equation}
L_p = \frac{\overline{h^3} W_0^3}{3\alpha g F_0}\mathcal{P}.
\end{equation}
\item The ``linear'' simulations, where we assume that $F_{\rm{conv}}$ decreases from a value of 0 at $L_{\rm{cz}}$ linearly, so $F(z > L_{\rm{cz}}) = -|\partial_z F_0|(z - L_{\rm{cz}})$.
We set $|\partial_z F_0| \sim \mathcal{P}^{-1}$ in these simulations.
In this case, integration yields
\begin{equation}
L_p = \left(\frac{2\overline{h^3} W_0^3}{3\alpha g|\partial_z F_0|}\right)^{1/2} \propto \sqrt{\mathcal{P}}.
\end{equation}
This is more directly the case mentioned by Zahn.
\end{enumerate}

Following a step further, we now adopt the assumption of MLT that the CZ flux is described by
\begin{equation}
F_{0} = \mathcal{F} W^3.
\end{equation}
The difficulty is in in determining the value of $\mathcal{F}$.
To achieve this, we return to Eqn.~\ref{eqn:buoyancy_integral} and integrate over the relevant length scale in the CZ (for the Boussinesq case, this is just the depth of the CZ),
\begin{equation}
\frac{\overline{h_{\rm{cz}}^3}}{3 \alpha g}\int_0^{W_0} dW^3 = \int_{0}^{L_{\rm{cz}}} F_0\, dz
\Rightarrow
F_0 = \frac{\overline{h_{\rm{cz}}^3} W_0^3}{3 \alpha g L_{\rm{cz}}},
\end{equation}
where above I have performed the integral for the ``erf'' case and assumed a constant $F_0$ in the CZ (I should be more careful about this, because internal heating, and my length scale is slightly off).
Plugging this expression for $F_0$ into the erf expression for $L_p$, we retrieve
\begin{equation}
\frac{L_p}{L_{\rm{cz}}} = \frac{\overline{h^3}}{\overline{h_{\rm{cz}}^3}} \mathcal{P},
\end{equation}
and we see that the penetration depth depends only on $\mathcal{P}$ and the horizontal extent of the upflows in the CZ compared to the PZ.
We expect the latter of these factors to be a weak function of things like the stiffness or the Reynolds number.
In the simulations I have thusfar conducted, I think I have found that the average filling factor $f$ of the flows decreases as you move upwards in the CZ (from something like 0.6 to 0.4); in the PZ it quickly returns to 0.5, and it stays 0.5 in the RZ (where waves dominate, and that makes sense).
However, I did these calculations using a pure filling factor calculation (``what fraction of the horizontal volume is filled with an upflow?''); I think a better algorithm which attempts to determine where the convective plumes are would be ideal.
Regardless, naively I think that $\overline{h^3} \approx f^{3/2}$ is probably a fine first assumption.
By that assumption, with the above numbers I quoted ($f_{\rm{cz}} \approx 0.6$ and $f_{\rm{pz}} \approx 0.4$), we get
\begin{equation}
\frac{L_p}{L_{\rm{cz}}} \approx \frac{f_{\rm{pz}}^{3/2}}{f_{\rm{cz}}^{3/2}}\mathcal{P} \approx 0.54 \mathcal{P}.
\end{equation}
This is strikingly close to what we are seeing in these simulations.


\bibliography{biblio.bib}
\end{document} 
